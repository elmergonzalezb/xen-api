<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class XenApi - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-async_task_manager">#async_task_manager</a>
    
    <li ><a href="#method-i-check_vdi_entity_is_nonexist">#check_vdi_entity_is_nonexist</a>
    
    <li ><a href="#method-i-check_vdi_entity_validity">#check_vdi_entity_validity</a>
    
    <li ><a href="#method-i-check_vdi_is_a_snapshot">#check_vdi_is_a_snapshot</a>
    
    <li ><a href="#method-i-check_vdi_is_iso">#check_vdi_is_iso</a>
    
    <li ><a href="#method-i-check_vdi_is_xs_iso">#check_vdi_is_xs_iso</a>
    
    <li ><a href="#method-i-check_vm_entity_is_dom0">#check_vm_entity_is_dom0</a>
    
    <li ><a href="#method-i-check_vm_entity_is_nonexist">#check_vm_entity_is_nonexist</a>
    
    <li ><a href="#method-i-check_vm_entity_is_paravirtual">#check_vm_entity_is_paravirtual</a>
    
    <li ><a href="#method-i-check_vm_entity_is_template">#check_vm_entity_is_template</a>
    
    <li ><a href="#method-i-check_vm_entity_validity">#check_vm_entity_validity</a>
    
    <li ><a href="#method-i-check_vm_template_validity">#check_vm_template_validity</a>
    
    <li ><a href="#method-i-list_task_all_records">#list_task_all_records</a>
    
    <li ><a href="#method-i-logout">#logout</a>
    
    <li ><a href="#method-i-network_add_tag">#network_add_tag</a>
    
    <li ><a href="#method-i-network_create">#network_create</a>
    
    <li ><a href="#method-i-network_destroy">#network_destroy</a>
    
    <li ><a href="#method-i-network_get_detail">#network_get_detail</a>
    
    <li ><a href="#method-i-network_get_tags">#network_get_tags</a>
    
    <li ><a href="#method-i-network_list">#network_list</a>
    
    <li ><a href="#method-i-network_rm_tag">#network_rm_tag</a>
    
    <li ><a href="#method-i-network_search_by_tag">#network_search_by_tag</a>
    
    <li ><a href="#method-i-number-3F">#number?</a>
    
    <li ><a href="#method-i-parse_last_boot_record">#parse_last_boot_record</a>
    
    <li ><a href="#method-i-random_mac">#random_mac</a>
    
    <li ><a href="#method-i-session_logout">#session_logout</a>
    
    <li ><a href="#method-i-task_cancel">#task_cancel</a>
    
    <li ><a href="#method-i-task_destroy">#task_destroy</a>
    
    <li ><a href="#method-i-task_get_error">#task_get_error</a>
    
    <li ><a href="#method-i-task_get_record">#task_get_record</a>
    
    <li ><a href="#method-i-task_get_result">#task_get_result</a>
    
    <li ><a href="#method-i-task_get_status">#task_get_status</a>
    
    <li ><a href="#method-i-vbd_create">#vbd_create</a>
    
    <li ><a href="#method-i-vbd_get_detail">#vbd_get_detail</a>
    
    <li ><a href="#method-i-vbd_list">#vbd_list</a>
    
    <li ><a href="#method-i-vdi_add_tag">#vdi_add_tag</a>
    
    <li ><a href="#method-i-vdi_destroy">#vdi_destroy</a>
    
    <li ><a href="#method-i-vdi_get_record">#vdi_get_record</a>
    
    <li ><a href="#method-i-vdi_get_tags">#vdi_get_tags</a>
    
    <li ><a href="#method-i-vdi_list">#vdi_list</a>
    
    <li ><a href="#method-i-vdi_list_snapshot">#vdi_list_snapshot</a>
    
    <li ><a href="#method-i-vdi_list_tools">#vdi_list_tools</a>
    
    <li ><a href="#method-i-vdi_resize">#vdi_resize</a>
    
    <li ><a href="#method-i-vdi_rm_tag">#vdi_rm_tag</a>
    
    <li ><a href="#method-i-vdi_search_by_tag">#vdi_search_by_tag</a>
    
    <li ><a href="#method-i-vif_create">#vif_create</a>
    
    <li ><a href="#method-i-vif_destroy">#vif_destroy</a>
    
    <li ><a href="#method-i-vif_get_detail">#vif_get_detail</a>
    
    <li ><a href="#method-i-vif_list">#vif_list</a>
    
    <li ><a href="#method-i-vif_plug">#vif_plug</a>
    
    <li ><a href="#method-i-vif_unplug">#vif_unplug</a>
    
    <li ><a href="#method-i-vm_add_other_config">#vm_add_other_config</a>
    
    <li ><a href="#method-i-vm_add_tag">#vm_add_tag</a>
    
    <li ><a href="#method-i-vm_clone">#vm_clone</a>
    
    <li ><a href="#method-i-vm_clone_from_template">#vm_clone_from_template</a>
    
    <li ><a href="#method-i-vm_destroy">#vm_destroy</a>
    
    <li ><a href="#method-i-vm_get_guest_metrics">#vm_get_guest_metrics</a>
    
    <li ><a href="#method-i-vm_get_guest_metrics_network">#vm_get_guest_metrics_network</a>
    
    <li ><a href="#method-i-vm_get_metrics">#vm_get_metrics</a>
    
    <li ><a href="#method-i-vm_get_other_config">#vm_get_other_config</a>
    
    <li ><a href="#method-i-vm_get_record">#vm_get_record</a>
    
    <li ><a href="#method-i-vm_get_tags">#vm_get_tags</a>
    
    <li ><a href="#method-i-vm_get_template_record">#vm_get_template_record</a>
    
    <li ><a href="#method-i-vm_get_vbds">#vm_get_vbds</a>
    
    <li ><a href="#method-i-vm_get_vifs">#vm_get_vifs</a>
    
    <li ><a href="#method-i-vm_list_all">#vm_list_all</a>
    
    <li ><a href="#method-i-vm_list_all_templates">#vm_list_all_templates</a>
    
    <li ><a href="#method-i-vm_power_off">#vm_power_off</a>
    
    <li ><a href="#method-i-vm_power_on">#vm_power_on</a>
    
    <li ><a href="#method-i-vm_power_pause">#vm_power_pause</a>
    
    <li ><a href="#method-i-vm_power_reboot">#vm_power_reboot</a>
    
    <li ><a href="#method-i-vm_power_unpause">#vm_power_unpause</a>
    
    <li ><a href="#method-i-vm_rm_other_config">#vm_rm_other_config</a>
    
    <li ><a href="#method-i-vm_rm_tag">#vm_rm_tag</a>
    
    <li ><a href="#method-i-vm_search_by_tag">#vm_search_by_tag</a>
    
    <li ><a href="#method-i-vm_set_max_ram">#vm_set_max_ram</a>
    
    <li ><a href="#method-i-vm_set_name">#vm_set_name</a>
    
    <li ><a href="#method-i-vm_set_other_config">#vm_set_other_config</a>
    
    <li ><a href="#method-i-xml_parse">#xml_parse</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-XenApi">
  <h1 id="class-XenApi" class="class">
    class XenApi
  </h1>

  <section class="description">
    
<p><a href="XenApi.html">XenApi</a> Session Manager</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(server_path, server_port = 443, username = 'root', password)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Initalize the API by login to XenServer. Params:</p>
<dl class="rdoc-list note-list"><dt><code>server_path</code>
<dd>
<p>Server Address</p>
</dd><dt><code>server_port</code>
<dd>
<p>Server API Port, useful while oeprate over SSH</p>
</dd><dt><code>username</code>   
<dd>
<p>Username, usually <em>root</em></p>
</dd><dt><code>password</code>   
<dd>
<p>Password, the password!</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 19</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">server_path</span>, <span class="ruby-identifier">server_port</span> = <span class="ruby-value">443</span>, <span class="ruby-identifier">username</span> = <span class="ruby-string">&#39;root&#39;</span>, <span class="ruby-identifier">password</span>)
  <span class="ruby-comment"># This is where the connection is made</span>
  <span class="ruby-comment"># https://stelfox.net/blog/2012/02/rubys-xmlrpc-client-and-ssl/</span>
  <span class="ruby-identifier">connection_param</span> = {
    <span class="ruby-identifier">host</span><span class="ruby-operator">:</span> <span class="ruby-identifier">server_path</span>,
    <span class="ruby-identifier">port</span><span class="ruby-operator">:</span> <span class="ruby-identifier">server_port</span>,
    <span class="ruby-identifier">use_ssl</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
    <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;/&#39;</span>
  }
  <span class="ruby-ivar">@connect</span> = <span class="ruby-constant">XMLRPC</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span>.<span class="ruby-identifier">new_from_hash</span>(<span class="ruby-identifier">connection_param</span>)
  <span class="ruby-comment"># This is the SSL Check Bypassing Mechanism</span>
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">http</span>.<span class="ruby-identifier">verify_mode</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_NONE</span>
  <span class="ruby-ivar">@session</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;session.login_with_password&#39;</span>, <span class="ruby-identifier">username</span>, <span class="ruby-identifier">password</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-list_task_all_records" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">list_task_all_records</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>All Task</p>
          
          

          
          <div class="method-source-code" id="list_task_all_records-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 534</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">list_task_all_records</span>
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;task.get_all_records&#39;</span>, <span class="ruby-ivar">@session</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-logout" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">logout</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>logout</p>

<p>Alias to <a href="XenApi.html#method-i-session_logout">#session_logout</a></p>
          
          

          
          <div class="method-source-code" id="logout-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 44</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">logout</span>
  <span class="ruby-identifier">session_logout</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-network_add_tag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">network_add_tag</span><span
            class="method-args">(network_opaqueref, tag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Tag a network</p>
<dl class="rdoc-list note-list"><dt><code>network_opaqueref</code>
<dd>
<p>OpaqueRef of the Network</p>
</dd><dt><code>tag</code>
<dd>
<p>the name tag</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="network_add_tag-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 873</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">network_add_tag</span>(<span class="ruby-identifier">network_opaqueref</span>, <span class="ruby-identifier">tag</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;network.add_tags&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">network_opaqueref</span>, <span class="ruby-identifier">tag</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-network_create" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">network_create</span><span
            class="method-args">(name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create a Internal Network</p>
<dl class="rdoc-list note-list"><dt><code>name</code>
<dd>
<p>Name of the Network</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="network_create-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 853</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">network_create</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">vbd_object</span> = {
    <span class="ruby-identifier">name_label</span><span class="ruby-operator">:</span> <span class="ruby-identifier">name</span>,
    <span class="ruby-constant">MTU</span><span class="ruby-operator">:</span> <span class="ruby-value">1500</span>,
    <span class="ruby-identifier">other_config</span><span class="ruby-operator">:</span> {}
  }
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;network.create&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vbd_object</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-network_destroy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">network_destroy</span><span
            class="method-args">(network_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Destroy a Internal Network</p>
<dl class="rdoc-list note-list"><dt><code>network_opaqueref</code>
<dd>
<p>OpaqueRef of the Network</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="network_destroy-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 865</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">network_destroy</span>(<span class="ruby-identifier">network_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;network.destroy&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">network_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-network_get_detail" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">network_get_detail</span><span
            class="method-args">(network_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get details of the network</p>
          
          

          
          <div class="method-source-code" id="network_get_detail-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 846</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">network_get_detail</span>(<span class="ruby-identifier">network_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;network.get_record&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">network_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-network_get_tags" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">network_get_tags</span><span
            class="method-args">(network_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get Tags of network</p>
<dl class="rdoc-list note-list"><dt><code>network_opaqueref</code>
<dd>
<p>OpaqueRef of the Network</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="network_get_tags-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 888</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">network_get_tags</span>(<span class="ruby-identifier">network_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;network.get_tags&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">network_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-network_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">network_list</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>List all network</p>
          
          

          
          <div class="method-source-code" id="network_list-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 840</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">network_list</span>
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;network.get_all&#39;</span>, <span class="ruby-ivar">@session</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-network_rm_tag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">network_rm_tag</span><span
            class="method-args">(network_opaqueref, tag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>UNTag a network</p>
<dl class="rdoc-list note-list"><dt><code>network_opaqueref</code>
<dd>
<p>OpaqueRef of the Network</p>
</dd><dt><code>tag</code>
<dd>
<p>the name tag</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="network_rm_tag-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 881</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">network_rm_tag</span>(<span class="ruby-identifier">network_opaqueref</span>, <span class="ruby-identifier">tag</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;network.remove_tags&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">network_opaqueref</span>, <span class="ruby-identifier">tag</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-network_search_by_tag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">network_search_by_tag</span><span
            class="method-args">(tag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Search network by Tag</p>
<dl class="rdoc-list note-list"><dt><code>tag</code>
<dd>
<p>the name tag</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="network_search_by_tag-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 895</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">network_search_by_tag</span>(<span class="ruby-identifier">tag</span>)
  <span class="ruby-identifier">networks</span> = <span class="ruby-identifier">network_list</span>[<span class="ruby-string">&#39;Value&#39;</span>]
  <span class="ruby-identifier">result</span> = <span class="ruby-identifier">networks</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">network_opaqueref</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">network_get_tags</span>(<span class="ruby-identifier">network_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">result</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-session_logout" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">session_logout</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Logout</p>
          
          

          
          <div class="method-source-code" id="session_logout-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">session_logout</span>
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;session.logout&#39;</span>, <span class="ruby-ivar">@session</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-task_cancel" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">task_cancel</span><span
            class="method-args">(task_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Cancel a task, important after Crashes Params:</p>
<dl class="rdoc-list note-list"><dt><code>task_opaqueref</code>
<dd>
<p>Task Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="task_cancel-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 582</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">task_cancel</span>(<span class="ruby-identifier">task_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;task.cancel&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">task_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-task_destroy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">task_destroy</span><span
            class="method-args">(task_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Destroy a task, important after working on a Async Task Params:</p>
<dl class="rdoc-list note-list"><dt><code>task_opaqueref</code>
<dd>
<p>Task Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="task_destroy-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 574</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">task_destroy</span>(<span class="ruby-identifier">task_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;task.destroy&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">task_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-task_get_error" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">task_get_error</span><span
            class="method-args">(task_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Task Errors Params:</p>
<dl class="rdoc-list note-list"><dt><code>task_opaqueref</code>
<dd>
<p>Task Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="task_get_error-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 566</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">task_get_error</span>(<span class="ruby-identifier">task_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;task.get_error_info&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">task_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-task_get_record" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">task_get_record</span><span
            class="method-args">(task_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get Task Record Params:</p>
<dl class="rdoc-list note-list"><dt><code>task_opaqueref</code>
<dd>
<p>Task Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="task_get_record-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 542</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">task_get_record</span>(<span class="ruby-identifier">task_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;task.get_record&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">task_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-task_get_result" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">task_get_result</span><span
            class="method-args">(task_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Task Result Params:</p>
<dl class="rdoc-list note-list"><dt><code>task_opaqueref</code>
<dd>
<p>Task Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="task_get_result-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 558</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">task_get_result</span>(<span class="ruby-identifier">task_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;task.get_result&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">task_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-task_get_status" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">task_get_status</span><span
            class="method-args">(task_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Task Status Params:</p>
<dl class="rdoc-list note-list"><dt><code>task_opaqueref</code>
<dd>
<p>Task Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="task_get_status-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 550</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">task_get_status</span>(<span class="ruby-identifier">task_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;task.get_status&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">task_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vbd_create" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vbd_create</span><span
            class="method-args">(vm_opaqueref, vdi_opaqueref, device_slot)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create a Virtual Block Device (Plugged Instantly) Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd><dt><code>vdi_opaqueref</code>
<dd>
<p>VDI Reference</p>
</dd><dt><code>device_slot</code>
<dd>
<p>VBD Device place</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vbd_create-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 758</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vbd_create</span>(<span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">vdi_opaqueref</span>, <span class="ruby-identifier">device_slot</span>)
  <span class="ruby-identifier">vbd_object</span> = {
    <span class="ruby-constant">VM</span><span class="ruby-operator">:</span> <span class="ruby-identifier">vm_opaqueref</span>,
    <span class="ruby-constant">VDI</span><span class="ruby-operator">:</span> <span class="ruby-identifier">vdi_opaqueref</span>,
    <span class="ruby-identifier">userdevice</span><span class="ruby-operator">:</span> <span class="ruby-identifier">device_slot</span>,
    <span class="ruby-identifier">bootable</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>,
    <span class="ruby-identifier">mode</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;RW&#39;</span>,
    <span class="ruby-identifier">type</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Disk&#39;</span>,
    <span class="ruby-identifier">empty</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>,
    <span class="ruby-identifier">qos_algorithm_type</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;&#39;</span>, <span class="ruby-comment"># TODO!</span>
    <span class="ruby-identifier">qos_algorithm_params</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-comment"># TODO!</span>
  }
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VBD.create&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vbd_object</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vbd_get_detail" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vbd_get_detail</span><span
            class="method-args">(vbd_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get detail of the specified VBD</p>
          
          

          
          <div class="method-source-code" id="vbd_get_detail-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 748</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vbd_get_detail</span>(<span class="ruby-identifier">vbd_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VBD.get_record&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vbd_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vbd_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vbd_list</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get all VBD on the system</p>
          
          

          
          <div class="method-source-code" id="vbd_list-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 742</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vbd_list</span>
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VBD.get_all&#39;</span>, <span class="ruby-ivar">@session</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vdi_add_tag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vdi_add_tag</span><span
            class="method-args">(vdi_opaqueref, tag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a tag to the specified VDI Params:</p>
<dl class="rdoc-list note-list"><dt><code>vdi_opaqueref</code>
<dd>
<p>VDI Identifier</p>
</dd><dt><code>tag</code>          
<dd>
<p>Tag</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vdi_add_tag-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 687</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vdi_add_tag</span>(<span class="ruby-identifier">vdi_opaqueref</span>, <span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vdi_entity_validity</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.add_tags&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>, <span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vdi_destroy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vdi_destroy</span><span
            class="method-args">(vdi_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Destroy the specified VDI Params:</p>
<dl class="rdoc-list note-list"><dt><code>vdi_opaqueref</code>
<dd>
<p>VDI Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vdi_destroy-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 673</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vdi_destroy</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vdi_entity_validity</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">vdi_task_token</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;Async.VDI.destroy&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>)
    <span class="ruby-identifier">async_task_manager</span>(<span class="ruby-identifier">vdi_task_token</span>, <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vdi_get_record" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vdi_get_record</span><span
            class="method-args">(vdi_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get detail of the specified VDI Params:</p>
<dl class="rdoc-list note-list"><dt><code>vdi_opaqueref</code>
<dd>
<p>VDI Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vdi_get_record-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 637</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vdi_get_record</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vdi_entity_validity</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">record</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.get_record&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>)
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;snapshot_time&#39;</span>] = <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;snapshot_time&#39;</span>].<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
      <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">record</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vdi_get_tags" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vdi_get_tags</span><span
            class="method-args">(vdi_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>get VDI tags Params:</p>
<dl class="rdoc-list note-list"><dt><code>vdi_opaqueref</code>
<dd>
<p>VDI Identifier</p>
</dd><dt><code>tag</code>          
<dd>
<p>Tag</p>
</dd></dl>

<p>Returns: Tags</p>
          
          

          
          <div class="method-source-code" id="vdi_get_tags-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 715</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vdi_get_tags</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vdi_entity_validity</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.get_tags&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vdi_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vdi_list</span><span
            class="method-args">(no_iso_cd)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get a list of all VDI</p>
<dl class="rdoc-list note-list"><dt><code>no_iso_cd</code>
<dd>
<p>Ignore ISO file?</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vdi_list-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 593</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vdi_list</span>(<span class="ruby-identifier">no_iso_cd</span>)
  <span class="ruby-identifier">all_records</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.get_all&#39;</span>, <span class="ruby-ivar">@session</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
  <span class="ruby-comment"># Filter Away Snapshots</span>
  <span class="ruby-identifier">no_snapshot</span> = <span class="ruby-identifier">all_records</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vdi_opaqueref</span><span class="ruby-operator">|</span>
    <span class="ruby-operator">!</span><span class="ruby-identifier">check_vdi_is_a_snapshot</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># Filter Away XS-Tools</span>
  <span class="ruby-identifier">filtered</span> = <span class="ruby-identifier">no_snapshot</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vdi_opaqueref</span><span class="ruby-operator">|</span>
    <span class="ruby-operator">!</span><span class="ruby-identifier">check_vdi_is_xs_iso</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">no_iso_cd</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
    <span class="ruby-identifier">filtered</span> = <span class="ruby-identifier">filtered</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vdi_opaqueref</span><span class="ruby-operator">|</span>
      <span class="ruby-operator">!</span><span class="ruby-identifier">check_vdi_is_iso</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">filtered</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vdi_list_snapshot" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vdi_list_snapshot</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get a list of all Snapshot VDI</p>
          
          

          
          <div class="method-source-code" id="vdi_list_snapshot-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 613</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vdi_list_snapshot</span>
  <span class="ruby-identifier">all_records</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.get_all&#39;</span>, <span class="ruby-ivar">@session</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
  <span class="ruby-comment"># Filter Away Snapshots</span>
  <span class="ruby-identifier">filtered</span> = <span class="ruby-identifier">all_records</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vdi_opaqueref</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">check_vdi_is_a_snapshot</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">filtered</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vdi_list_tools" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vdi_list_tools</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get XS-TOOLS VDI</p>
          
          

          
          <div class="method-source-code" id="vdi_list_tools-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 624</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vdi_list_tools</span>
  <span class="ruby-identifier">all_records</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.get_all&#39;</span>, <span class="ruby-ivar">@session</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
  <span class="ruby-comment"># Filter Away all butXS-Tools</span>
  <span class="ruby-identifier">filtered</span> = <span class="ruby-identifier">all_records</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vdi_opaqueref</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">check_vdi_is_xs_iso</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">filtered</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vdi_resize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vdi_resize</span><span
            class="method-args">(vdi_opaqueref, new_vdi_size)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Resize the specified VDI Params:</p>
<dl class="rdoc-list note-list"><dt><code>vdi_opaqueref</code>
<dd>
<p>VDI Reference</p>
</dd><dt><code>new_vdi_size</code>
<dd>
<p>New Size of the VDI</p>
</dd></dl>

<p>FIXME: This is broken by the limitations of XMLRPC Library</p>
          
          

          
          <div class="method-source-code" id="vdi_resize-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 657</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vdi_resize</span>(<span class="ruby-identifier">vdi_opaqueref</span>, <span class="ruby-identifier">new_vdi_size</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vdi_entity_validity</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.resize_online&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>, <span class="ruby-identifier">new_vdi_size</span>)
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">RuntimeError</span>
      <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_unsupported</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vdi_rm_tag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vdi_rm_tag</span><span
            class="method-args">(vdi_opaqueref, tag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Unset VDI tags Params:</p>
<dl class="rdoc-list note-list"><dt><code>vdi_opaqueref</code>
<dd>
<p>VDI Identifier</p>
</dd><dt><code>tag</code>          
<dd>
<p>Tag</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vdi_rm_tag-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 700</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vdi_rm_tag</span>(<span class="ruby-identifier">vdi_opaqueref</span>, <span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vdi_entity_validity</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.remove_tags&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>, <span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vdi_search_by_tag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vdi_search_by_tag</span><span
            class="method-args">(tag, no_iso_cd)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Search VDI by tag</p>
<dl class="rdoc-list note-list"><dt><code>tag</code>         
<dd>
<p>Tag</p>
</dd></dl>

<p>Returns Matched VM</p>
          
          

          
          <div class="method-source-code" id="vdi_search_by_tag-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 727</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vdi_search_by_tag</span>(<span class="ruby-identifier">tag</span>, <span class="ruby-identifier">no_iso_cd</span>)
  <span class="ruby-identifier">all_vdi</span> = <span class="ruby-identifier">vdi_list</span>(<span class="ruby-identifier">no_iso_cd</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
  <span class="ruby-identifier">result</span> = <span class="ruby-identifier">all_vdi</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vdi_opaqueref</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">vdi_get_tags</span>(<span class="ruby-identifier">vdi_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">result</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vif_create" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vif_create</span><span
            class="method-args">(vm_opaqueref, net_opaqueref, slot)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create a VIF</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>OpaqueRef of target VM</p>
</dd><dt><code>net_opaqueref</code>
<dd>
<p>Network to be plugged</p>
</dd><dt><code>slot</code>
<dd>
<p>Where the VIF is “inserted”</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vif_create-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 795</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vif_create</span>(<span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">net_opaqueref</span>, <span class="ruby-identifier">slot</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">vbd_object</span> = {
      <span class="ruby-identifier">device</span><span class="ruby-operator">:</span> <span class="ruby-identifier">slot</span>.<span class="ruby-identifier">to_i</span>,
      <span class="ruby-identifier">network</span><span class="ruby-operator">:</span> <span class="ruby-identifier">net_opaqueref</span>,
      <span class="ruby-constant">VM</span><span class="ruby-operator">:</span> <span class="ruby-identifier">vm_opaqueref</span>,
      <span class="ruby-constant">MAC</span><span class="ruby-operator">:</span> <span class="ruby-identifier">random_mac</span>,
      <span class="ruby-constant">MTU</span><span class="ruby-operator">:</span> <span class="ruby-value">1500</span>,
      <span class="ruby-identifier">other_config</span><span class="ruby-operator">:</span> {},
      <span class="ruby-identifier">qos_algorithm_type</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;&#39;</span>, <span class="ruby-comment"># TODO!</span>
      <span class="ruby-identifier">qos_algorithm_params</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-comment"># TODO!</span>
    }
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VIF.create&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vbd_object</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vif_destroy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vif_destroy</span><span
            class="method-args">(vif_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Destroy the specified VIF</p>
<dl class="rdoc-list note-list"><dt><code>vif_opaqueref</code>
<dd>
<p>OpaqueRef of the VIF</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vif_destroy-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 816</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vif_destroy</span>(<span class="ruby-identifier">vif_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VIF.destroy&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vif_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vif_get_detail" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vif_get_detail</span><span
            class="method-args">(vif_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get details of the specified VIF</p>
<dl class="rdoc-list note-list"><dt><code>vif_opaqueref</code>
<dd>
<p>OpaqueRef of the VIF</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vif_get_detail-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 786</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vif_get_detail</span>(<span class="ruby-identifier">vif_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VIF.get_record&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vif_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vif_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vif_list</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>List all VIF</p>
          
          

          
          <div class="method-source-code" id="vif_list-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 779</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vif_list</span>
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VIF.get_all&#39;</span>, <span class="ruby-ivar">@session</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vif_plug" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vif_plug</span><span
            class="method-args">(vif_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Plug the VIF</p>
<dl class="rdoc-list note-list"><dt><code>vif_opaqueref</code>
<dd>
<p>OpaqueRef of the VIF</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vif_plug-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 823</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vif_plug</span>(<span class="ruby-identifier">vif_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VIF.plug&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vif_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vif_unplug" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vif_unplug</span><span
            class="method-args">(vif_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>UnPlug the VIF</p>
<dl class="rdoc-list note-list"><dt><code>vif_opaqueref</code>
<dd>
<p>OpaqueRef of the VIF</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vif_unplug-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 830</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vif_unplug</span>(<span class="ruby-identifier">vif_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VIF.unplug&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vif_opaqueref</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_add_other_config" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_add_other_config</span><span
            class="method-args">(vm_opaqueref, key, value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add “other config”, useful for official PV Instance template Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Identifier</p>
</dd><dt><code>key</code>         
<dd>
<p>Config Key</p>
</dd><dt><code>value</code>       
<dd>
<p>Config Value</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_add_other_config-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 391</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_add_other_config</span>(<span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.add_to_other_config&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_add_tag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_add_tag</span><span
            class="method-args">(vm_opaqueref, tag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a tag to the specified VM Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Identifier</p>
</dd><dt><code>tag</code>         
<dd>
<p>Tag</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_add_tag-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 444</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_add_tag</span>(<span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.add_tags&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_clone" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_clone</span><span
            class="method-args">(old_vm_opaqueref, new_vm_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clone the target Virtual Machine Returns the reference point of new vm
APIDoc P111, Copy tends to be more guaranteed. Params:</p>
<dl class="rdoc-list note-list"><dt><code>old_vm_opaqueref</code>
<dd>
<p>Source VM Identifier</p>
</dd><dt><code>new_vm_name</code>     
<dd>
<p>Name of the new VM</p>
</dd></dl>

<p>Returns: the record of new vm</p>
          
          

          
          <div class="method-source-code" id="vm_clone-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 290</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_clone</span>(<span class="ruby-identifier">old_vm_opaqueref</span>, <span class="ruby-identifier">new_vm_name</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">old_vm_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">new_vm_name</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">new_vm_name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span>
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># The NULL Reference is required to fulfill the requirement.</span>
    <span class="ruby-identifier">task_token</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;Async.VM.copy&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">old_vm_opaqueref</span>, <span class="ruby-identifier">new_vm_name</span>, <span class="ruby-string">&#39;OpaqueRef:NULL&#39;</span>)
    <span class="ruby-identifier">result</span> = <span class="ruby-identifier">async_task_manager</span>(<span class="ruby-identifier">task_token</span>, <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;Status&#39;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">result</span>[<span class="ruby-string">&#39;Status&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Error&#39;</span>
      <span class="ruby-identifier">result</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">result</span>[<span class="ruby-string">&#39;value&#39;</span>])
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_clone_from_template" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_clone_from_template</span><span
            class="method-args">(vm_tpl_opaqueref, new_vm_name, pv_boot_param, repo_url, distro, distro_release, net_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clone from PV Template TODO: Test Required Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_tpl_opaqueref</code>
<dd>
<p>Source Template Identifier</p>
</dd><dt><code>new_vm_name</code>          
<dd>
<p>Name of the new VM</p>
</dd><dt><code>pv_boot_param</code>        
<dd>
<p>Boot Command Line</p>
</dd><dt><code>repo_url</code>             
<dd>
<p>URL of the Distro Repo</p>
</dd><dt><code>distro</code>               
<dd>
<p>Distro Family, acceptable values are <em>debian</em> and <em>rhel</em></p>
</dd><dt><code>distro_release</code>       
<dd>
<p>Release Name of the specified Debian/Ubuntu Release. example:
<em>jessie</em>(Debian 8), <em>trusty</em>(Ubuntu 14.04)</p>
</dd></dl>

<p>Returns: the record of new vm</p>
          
          

          
          <div class="method-source-code" id="vm_clone_from_template-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 317</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_clone_from_template</span>(<span class="ruby-identifier">vm_tpl_opaqueref</span>, <span class="ruby-identifier">new_vm_name</span>, <span class="ruby-identifier">pv_boot_param</span>, <span class="ruby-identifier">repo_url</span>, <span class="ruby-identifier">distro</span>, <span class="ruby-identifier">distro_release</span>, <span class="ruby-identifier">net_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_template_validity</span>(<span class="ruby-identifier">vm_tpl_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">new_vm_name</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">new_vm_name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span>
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Step0.1: Copy from template.</span>
    <span class="ruby-comment"># The NULL Reference is required to fulfill the params requirement.</span>
    <span class="ruby-identifier">task_token</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;Async.VM.copy&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_tpl_opaqueref</span>, <span class="ruby-identifier">new_vm_name</span>, <span class="ruby-string">&#39;OpaqueRef:NULL&#39;</span>)
    <span class="ruby-comment"># Step0.2: get new vm reference point</span>
    <span class="ruby-identifier">result</span> = <span class="ruby-identifier">async_task_manager</span>(<span class="ruby-identifier">task_token</span>, <span class="ruby-keyword">true</span>)[<span class="ruby-string">&#39;value&#39;</span>]
    <span class="ruby-comment"># Step 1 : Set boot paramaters, For configuring the kickstart definition</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.set_PV_args&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">result</span>, <span class="ruby-identifier">pv_boot_param</span>)
    <span class="ruby-comment"># Step 2 : Set repository URL, important for install</span>
    <span class="ruby-comment">#          Always skip step if previous step has error</span>
    <span class="ruby-comment">#     2.1: Handling Debian-based</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">distro</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;debian&#39;</span>
      <span class="ruby-comment"># Set New Value</span>
      <span class="ruby-identifier">s</span> = <span class="ruby-identifier">vm_set_other_config</span>(<span class="ruby-identifier">result</span>, <span class="ruby-string">&#39;debian-release&#39;</span>, <span class="ruby-identifier">distro_release</span>)
      <span class="ruby-identifier">s</span> = <span class="ruby-identifier">vm_set_other_config</span>(<span class="ruby-identifier">result</span>, <span class="ruby-string">&#39;install-repository&#39;</span>, <span class="ruby-identifier">repo_url</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">s</span>[<span class="ruby-string">&#39;Status&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;Success&#39;</span>
      <span class="ruby-comment">#     2.2: Handling EL (RH-related, like Fedora, CentOS, RHEL)</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">distro</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;rhel&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">distro</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;sle&#39;</span>
      <span class="ruby-identifier">s</span> = <span class="ruby-identifier">vm_set_other_config</span>(<span class="ruby-identifier">result</span>, <span class="ruby-string">&#39;install-repository&#39;</span>, <span class="ruby-identifier">repo_url</span>)
    <span class="ruby-comment"># Other distro is HVM so we ignore it.</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_unsupported</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">s</span>[<span class="ruby-string">&#39;Status&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Error&#39;</span>
      <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_unknown</span>(<span class="ruby-identifier">s</span>[<span class="ruby-string">&#39;ErrorDescription&#39;</span>])
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">s</span> = <span class="ruby-identifier">vif_create</span>(<span class="ruby-identifier">result</span>, <span class="ruby-identifier">net_opaqueref</span>, <span class="ruby-value">0</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">s</span>[<span class="ruby-string">&#39;Status&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Error&#39;</span>
        <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_unknown</span>(<span class="ruby-identifier">s</span>[<span class="ruby-string">&#39;ErrorDescription&#39;</span>])
      <span class="ruby-keyword">else</span>
        <span class="ruby-comment"># callback the new vm OpaqueRef</span>
        <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">result</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_destroy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_destroy</span><span
            class="method-args">(old_vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Erase the target Virtual Machine, along with related VDIs Params:</p>
<dl class="rdoc-list note-list"><dt><code>old_vm_opaqueref</code>
<dd>
<p>VM Identifier</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_destroy-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 360</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_destroy</span>(<span class="ruby-identifier">old_vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">old_vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Get /dev/xvda VDI Reference Code First.</span>
    <span class="ruby-identifier">vbd_sets</span> = <span class="ruby-identifier">vm_get_vbds</span>(<span class="ruby-identifier">old_vm_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
    <span class="ruby-identifier">xvda_id</span> = <span class="ruby-string">&#39;&#39;</span>
    <span class="ruby-identifier">vbd_sets</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vbd_opaqueref</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">record</span> = <span class="ruby-identifier">vbd_get_detail</span>(<span class="ruby-identifier">vbd_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;type&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;Disk&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;device&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;xvda&#39;</span>
      <span class="ruby-identifier">xvda_id</span> = <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;VDI&#39;</span>]
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># Delete VM</span>
    <span class="ruby-identifier">task_token</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;Async.VM.destroy&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">old_vm_opaqueref</span>)
    <span class="ruby-identifier">result</span> = <span class="ruby-identifier">async_task_manager</span>(<span class="ruby-identifier">task_token</span>, <span class="ruby-keyword">false</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span>[<span class="ruby-string">&#39;Status&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Success&#39;</span>
      <span class="ruby-comment"># Delete VM OK =&gt; Cleanup residue: /dev/xvda VDI</span>
      <span class="ruby-identifier">vdi_destroy</span>(<span class="ruby-identifier">xvda_id</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment"># Prompt Error on Deleting VM</span>
      <span class="ruby-identifier">result</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_get_guest_metrics" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_get_guest_metrics</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get Various Runtime Detail about the VM Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_get_guest_metrics-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 158</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_get_guest_metrics</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ref</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_guest_metrics&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
    <span class="ruby-identifier">dat</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM_guest_metrics.get_record&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">ref</span>)
    <span class="ruby-comment"># convert mess stuffs to Human-readable</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;last_updated&#39;</span>] = <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;last_updated&#39;</span>].<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
      <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;last_updated&#39;</span>] = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># Output. return is redundant in Ruby World.</span>
    <span class="ruby-identifier">dat</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_get_guest_metrics_network" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_get_guest_metrics_network</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get VM Network IPs <a
href="http://discussions.citrix.com/topic/244784-how-to-get-ip-address-of-vm-network-adapters">discussions.citrix.com/topic/244784-how-to-get-ip-address-of-vm-network-adapters</a>/
Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_get_guest_metrics_network-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_get_guest_metrics_network</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ref</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_guest_metrics&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM_guest_metrics.get_networks&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">ref</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_get_metrics" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_get_metrics</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get Various Physical Details about the VM Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_get_metrics-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 133</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_get_metrics</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ref</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_metrics&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
    <span class="ruby-identifier">dat</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM_metrics.get_record&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">ref</span>)
    <span class="ruby-comment"># convert mess stuffs to Human-readable</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;start_time&#39;</span>]   = <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;last_updated&#39;</span>].<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;install_time&#39;</span>] = <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;last_updated&#39;</span>].<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;last_updated&#39;</span>] = <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;last_updated&#39;</span>].<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
      <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;start_time&#39;</span>]   = <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;install_time&#39;</span>] = <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">dat</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;last_updated&#39;</span>] = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># Output. return is redundant in Ruby World.</span>
    <span class="ruby-identifier">dat</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_get_other_config" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_get_other_config</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get other_config field. Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Identifier</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_get_other_config-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 416</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_get_other_config</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-identifier">record</span> = <span class="ruby-identifier">vm_get_record</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;Status&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;Success&#39;</span>
    <span class="ruby-identifier">record</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;Value&#39;</span>][<span class="ruby-string">&#39;other_config&#39;</span>])
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_get_record" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_get_record</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get Virtual Machines Detail by OpaqueRef Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_get_record-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 86</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_get_record</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">record</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_record&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
    <span class="ruby-comment"># Post processing</span>
    <span class="ruby-comment"># 1. Decode Time Object to Human-readable</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;snapshot_time&#39;</span>] = <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;snapshot_time&#39;</span>].<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
      <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># 2. Last Boot Record is JSON, decode to Ruby Hash so that it won&#39;t clash</span>
    <span class="ruby-comment">#    the JSON generator</span>
    <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;last_booted_record&#39;</span>] = <span class="ruby-identifier">parse_last_boot_record</span>(<span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;last_booted_record&#39;</span>])
    <span class="ruby-comment"># 3. Parse Recommendations into Hash, using oga</span>
    <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;recommendations&#39;</span>] = <span class="ruby-identifier">xml_parse</span>(<span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;recommendations&#39;</span>])
    <span class="ruby-comment"># Output. return is redundant in Ruby World.</span>
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">record</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_get_tags" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_get_tags</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get VM tags Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Identifier</p>
</dd><dt><code>tag</code>         
<dd>
<p>Tag</p>
</dd></dl>

<p>Returns: Tags</p>
          
          

          
          <div class="method-source-code" id="vm_get_tags-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 472</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_get_tags</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_tags&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_get_template_record" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_get_template_record</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get Virtual Machines Detail by OpaqueRef Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_get_template_record-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 112</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_get_template_record</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_is_nonexist</span>(<span class="ruby-identifier">vm_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">check_vm_entity_is_dom0</span>(<span class="ruby-identifier">vm_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">vm_opaqueref</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">vm_opaqueref</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">record</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_record&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
    <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;recommendations&#39;</span>] = <span class="ruby-identifier">xml_parse</span>(<span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;recommendations&#39;</span>])
    <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;other_config&#39;</span>][<span class="ruby-string">&#39;disks&#39;</span>] = <span class="ruby-identifier">xml_parse</span>(<span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;other_config&#39;</span>][<span class="ruby-string">&#39;disks&#39;</span>])
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;snapshot_time&#39;</span>] = <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;snapshot_time&#39;</span>].<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
      <span class="ruby-identifier">record</span>[<span class="ruby-string">&#39;snapshot_time&#39;</span>] = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># Output. return is redundant in Ruby World.</span>
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">record</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_get_vbds" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_get_vbds</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get Block Devices of the specified VM Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_get_vbds-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 192</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_get_vbds</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_VBDs&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_get_vifs" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_get_vifs</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get Virtual Network Interfaces (VIFs) of the specified VM Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_get_vifs-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 204</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_get_vifs</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_VIFs&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_list_all" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_list_all</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get All Virtual Machines Using list instead to circumvent RuboCop</p>
          
          

          
          <div class="method-source-code" id="vm_list_all-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 51</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_list_all</span>
  <span class="ruby-identifier">all_records</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_all&#39;</span>, <span class="ruby-ivar">@session</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
  <span class="ruby-comment"># Filter Away Control Domain</span>
  <span class="ruby-identifier">no_dom0</span> = <span class="ruby-identifier">all_records</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vm_opaqueref</span><span class="ruby-operator">|</span>
    <span class="ruby-operator">!</span><span class="ruby-identifier">check_vm_entity_is_dom0</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># Filter Away Template</span>
  <span class="ruby-identifier">filtered</span> = <span class="ruby-identifier">no_dom0</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vm_opaqueref</span><span class="ruby-operator">|</span>
    <span class="ruby-operator">!</span><span class="ruby-identifier">check_vm_entity_is_template</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">filtered</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_list_all_templates" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_list_all_templates</span><span
            class="method-args">(pv)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get all Templates Params:</p>
<dl class="rdoc-list note-list"><dt><code>pv</code>
<dd>
<p>Paravirtual Templates Only?</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_list_all_templates-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 68</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_list_all_templates</span>(<span class="ruby-identifier">pv</span>)
  <span class="ruby-identifier">all_records</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_all&#39;</span>, <span class="ruby-ivar">@session</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
  <span class="ruby-comment"># Filter Away non-template (VM Instances + dom0)</span>
  <span class="ruby-identifier">all_templates</span> = <span class="ruby-identifier">all_records</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tpl_opaqueref</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">check_vm_entity_is_template</span>(<span class="ruby-identifier">tpl_opaqueref</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">pv</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
    <span class="ruby-identifier">all_templates</span> = <span class="ruby-identifier">all_templates</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tpl_opaqueref</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">check_vm_entity_is_paravirtual</span>(<span class="ruby-identifier">tpl_opaqueref</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc_with_payload</span>(<span class="ruby-identifier">all_templates</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_power_off" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_power_off</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Power OFF the specified Virtual Machine Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_power_off-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 229</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_power_off</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">task_token</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;Async.VM.shutdown&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-identifier">async_task_manager</span>(<span class="ruby-identifier">task_token</span>, <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_power_on" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_power_on</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Power ON the specified Virtual Machine Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_power_on-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 216</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_power_on</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">task_token</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;Async.VM.start&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-keyword">false</span>, <span class="ruby-keyword">false</span>)
    <span class="ruby-identifier">async_task_manager</span>(<span class="ruby-identifier">task_token</span>, <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_power_pause" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_power_pause</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Suspend the specified Virtual Machine Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_power_pause-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 255</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_power_pause</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># API Manual P116</span>
    <span class="ruby-comment"># void suspend (session_id s, VM ref vm)</span>
    <span class="ruby-identifier">task_token</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;Async.VM.suspend&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-identifier">async_task_manager</span>(<span class="ruby-identifier">task_token</span>, <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_power_reboot" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_power_reboot</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Reboot the specified Virtual Machines Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_power_reboot-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 242</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_power_reboot</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">task_token</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;Async.VM.hard_reboot&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-identifier">async_task_manager</span>(<span class="ruby-identifier">task_token</span>, <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_power_unpause" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_power_unpause</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Wake up the specified Virtual Machine Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Reference</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_power_unpause-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 270</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_power_unpause</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># API Manual P116-117</span>
    <span class="ruby-comment"># void resume (session_id s, VM ref vm, bool start_paused, bool force)</span>
    <span class="ruby-identifier">task_token</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;Async.VM.resume&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-keyword">false</span>, <span class="ruby-keyword">false</span>)
    <span class="ruby-identifier">async_task_manager</span>(<span class="ruby-identifier">task_token</span>, <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_rm_other_config" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_rm_other_config</span><span
            class="method-args">(vm_opaqueref, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Unset “other config”, useful for official PV Instance template Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Identifier</p>
</dd><dt><code>key</code>         
<dd>
<p>Config Key</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_rm_other_config-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 404</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_rm_other_config</span>(<span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.remove_from_other_config&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_rm_tag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_rm_tag</span><span
            class="method-args">(vm_opaqueref, tag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Unset VM tags Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Identifier</p>
</dd><dt><code>tag</code>         
<dd>
<p>Tag</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_rm_tag-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 457</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_rm_tag</span>(<span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.remove_tags&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_search_by_tag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_search_by_tag</span><span
            class="method-args">(tag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>search VM by tag Params:</p>
<dl class="rdoc-list note-list"><dt><code>tag</code>         
<dd>
<p>Tag</p>
</dd></dl>

<p>Returns: Matched VM</p>
          
          

          
          <div class="method-source-code" id="vm_search_by_tag-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 486</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_search_by_tag</span>(<span class="ruby-identifier">tag</span>)
  <span class="ruby-identifier">all_vm</span> = <span class="ruby-identifier">vm_list_all</span>
  <span class="ruby-identifier">all_vm</span>[<span class="ruby-string">&#39;Value&#39;</span>].<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">vm_opaqueref</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">vm_get_tags</span>(<span class="ruby-identifier">vm_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_set_max_ram" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_set_max_ram</span><span
            class="method-args">(vm_opaqueref, max_size)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set VM Memory Size</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM OpaqueRef</p>
</dd><dt><code>max_size</code>
<dd>
<p>Memory Capacity</p>
</dd><dt><code>min_size</code>
<dd>
<p>Memory Baseline</p>
</dd></dl>
<hr>

<p>XMLRPC Library only accepts 32-bit SignedInt 2147483648 (2GB actual value)
will cause RuntimeError: Integer is too big! Must be signed 32-bit integer!
WHAT THE HELL.</p>
<hr>
          
          

          
          <div class="method-source-code" id="vm_set_max_ram-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 516</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_set_max_ram</span>(<span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">max_size</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.set_memory_static_max&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">max_size</span>.<span class="ruby-identifier">to_i</span>)
      <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.set_memory_dynamic_max&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">max_size</span>.<span class="ruby-identifier">to_i</span>)
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">RuntimeError</span>
      <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_unsupported</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_set_name" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_set_name</span><span
            class="method-args">(vm_opaqueref, vm_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set VM Name</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM OpaqueRef</p>
</dd><dt><code>vm_name</code>
<dd>
<p>VM Name</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_set_name-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 497</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_set_name</span>(<span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">vm_name</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.set_name_label&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">vm_name</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vm_set_other_config" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vm_set_other_config</span><span
            class="method-args">(vm_opaqueref, key, value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set “other config”, useful for official PV Instance template Params:</p>
<dl class="rdoc-list note-list"><dt><code>vm_opaqueref</code>
<dd>
<p>VM Identifier</p>
</dd><dt><code>key</code>         
<dd>
<p>Config Key</p>
</dd><dt><code>value</code>       
<dd>
<p>Config Value</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="vm_set_other_config-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 431</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vm_set_other_config</span>(<span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_not_permitted</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.add_to_other_config&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>, <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

    
      <div id="method-i-async_task_manager" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">async_task_manager</span><span
            class="method-args">(task_opaqueref, has_payload)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Refactor: AsyncTask Task Manager It would poll the server continuously for
task status</p>
          
          

          
          <div class="method-source-code" id="async_task_manager-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 997</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">async_task_manager</span>(<span class="ruby-identifier">task_opaqueref</span>, <span class="ruby-identifier">has_payload</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">task_opaqueref</span>[<span class="ruby-string">&#39;Status&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;Success&#39;</span>
    <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_switch</span>(<span class="ruby-identifier">task_opaqueref</span>[<span class="ruby-string">&#39;ErrorDescription&#39;</span>][<span class="ruby-value">0</span>][<span class="ruby-value">0</span>])
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">task_status</span> = <span class="ruby-identifier">task_get_status</span>(<span class="ruby-identifier">task_opaqueref</span>[<span class="ruby-string">&#39;Value&#39;</span>])[<span class="ruby-string">&#39;Value&#39;</span>]
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">task_status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;pending&#39;</span>
      <span class="ruby-identifier">task_status</span> = <span class="ruby-identifier">task_get_status</span>(<span class="ruby-identifier">task_opaqueref</span>[<span class="ruby-string">&#39;Value&#39;</span>])[<span class="ruby-string">&#39;Value&#39;</span>]
      <span class="ruby-identifier">sleep</span>(<span class="ruby-value">5</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">task_status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;success&#39;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">has_payload</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">task_destroy</span>(<span class="ruby-identifier">task_opaqueref</span>[<span class="ruby-string">&#39;Value&#39;</span>])
      <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">success_nodesc</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">task_status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;success&#39;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">has_payload</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
      <span class="ruby-identifier">result</span> = <span class="ruby-identifier">task_get_result</span>(<span class="ruby-identifier">task_opaqueref</span>[<span class="ruby-string">&#39;Value&#39;</span>])
      <span class="ruby-identifier">task_destroy</span>(<span class="ruby-identifier">task_opaqueref</span>[<span class="ruby-string">&#39;Value&#39;</span>])
      <span class="ruby-identifier">result</span>[<span class="ruby-string">&#39;Value&#39;</span>] = <span class="ruby-identifier">xml_parse</span>(<span class="ruby-identifier">result</span>[<span class="ruby-string">&#39;Value&#39;</span>])
      <span class="ruby-identifier">result</span>[<span class="ruby-string">&#39;Value&#39;</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">error_info</span> = <span class="ruby-identifier">task_get_error</span>(<span class="ruby-identifier">task_opaqueref</span>[<span class="ruby-string">&#39;Value&#39;</span>])[<span class="ruby-string">&#39;Value&#39;</span>]
      <span class="ruby-identifier">task_destroy</span>(<span class="ruby-identifier">task_opaqueref</span>[<span class="ruby-string">&#39;Value&#39;</span>])
      <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_unknown</span>(<span class="ruby-identifier">error_info</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vdi_entity_is_nonexist" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vdi_entity_is_nonexist</span><span
            class="method-args">(vdi_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Filter: Check VDI Existency</p>
          
          

          
          <div class="method-source-code" id="check_vdi_entity_is_nonexist-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 963</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vdi_entity_is_nonexist</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.get_uuid&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>)[<span class="ruby-string">&#39;Status&#39;</span>]
  <span class="ruby-identifier">result</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Success&#39;</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vdi_entity_validity" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vdi_entity_validity</span><span
            class="method-args">(vdi_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Refactor: Aggregated VDI Validity Check</p>
          
          

          
          <div class="method-source-code" id="check_vdi_entity_validity-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 986</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vdi_entity_validity</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-identifier">check_vdi_entity_is_nonexist</span>(<span class="ruby-identifier">vdi_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">check_vdi_is_a_snapshot</span>(<span class="ruby-identifier">vdi_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">check_vdi_is_xs_iso</span>(<span class="ruby-identifier">vdi_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">vdi_opaqueref</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">vdi_opaqueref</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vdi_is_a_snapshot" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vdi_is_a_snapshot</span><span
            class="method-args">(vdi_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Filter: Ignore Snapshots</p>
          
          

          
          <div class="method-source-code" id="check_vdi_is_a_snapshot-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 957</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vdi_is_a_snapshot</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.get_is_a_snapshot&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vdi_is_iso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vdi_is_iso</span><span
            class="method-args">(vdi_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Filter: Ignore ISO and Hypervisor host CD drive Only HDD Image can clone.
resize is OK but it will not show running disk.</p>
          
          

          
          <div class="method-source-code" id="check_vdi_is_iso-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 949</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vdi_is_iso</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.get_allowed_operations&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
  <span class="ruby-identifier">read_only</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.get_read_only&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
  <span class="ruby-identifier">result</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&#39;clone&#39;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">read_only</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vdi_is_xs_iso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vdi_is_xs_iso</span><span
            class="method-args">(vdi_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Filter: Ignore XS-Tools ISO</p>
          
          

          
          <div class="method-source-code" id="check_vdi_is_xs_iso-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 942</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vdi_is_xs_iso</span>(<span class="ruby-identifier">vdi_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VDI.get_is_tools_iso&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vdi_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vm_entity_is_dom0" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vm_entity_is_dom0</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Filter: Check the requested VM entity is the dom0 or not.</p>
          
          

          
          <div class="method-source-code" id="check_vm_entity_is_dom0-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 913</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vm_entity_is_dom0</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_is_control_domain&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vm_entity_is_nonexist" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vm_entity_is_nonexist</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Filter: Check VM Existency</p>
          
          

          
          <div class="method-source-code" id="check_vm_entity_is_nonexist-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 925</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vm_entity_is_nonexist</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_uuid&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)[<span class="ruby-string">&#39;Status&#39;</span>]
  <span class="ruby-identifier">result</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Success&#39;</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vm_entity_is_paravirtual" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vm_entity_is_paravirtual</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Filter: Check VM IS PV</p>
          
          

          
          <div class="method-source-code" id="check_vm_entity_is_paravirtual-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 932</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vm_entity_is_paravirtual</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_PV_bootloader&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
  <span class="ruby-comment"># PV Templates always have pygrub in PV_bootloader field</span>
  <span class="ruby-comment"># https://wiki.xenproject.org/wiki/XCP_PV_templates_start</span>
  <span class="ruby-comment"># pygrub will be used after install finished</span>
  <span class="ruby-identifier">result</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;eliloader&#39;</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vm_entity_is_template" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vm_entity_is_template</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Filter: Check the requested VM entity is an Template or not.</p>
          
          

          
          <div class="method-source-code" id="check_vm_entity_is_template-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 919</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vm_entity_is_template</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-ivar">@connect</span>.<span class="ruby-identifier">call</span>(<span class="ruby-string">&#39;VM.get_is_a_template&#39;</span>, <span class="ruby-ivar">@session</span>, <span class="ruby-identifier">vm_opaqueref</span>)[<span class="ruby-string">&#39;Value&#39;</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vm_entity_validity" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vm_entity_validity</span><span
            class="method-args">(vm_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Refactor: Aggregated Validity Check</p>
          
          

          
          <div class="method-source-code" id="check_vm_entity_validity-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 974</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vm_entity_validity</span>(<span class="ruby-identifier">vm_opaqueref</span>)
  <span class="ruby-identifier">check_vm_entity_is_nonexist</span>(<span class="ruby-identifier">vm_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">check_vm_entity_is_dom0</span>(<span class="ruby-identifier">vm_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">check_vm_entity_is_template</span>(<span class="ruby-identifier">vm_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">vm_opaqueref</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">vm_opaqueref</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_vm_template_validity" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_vm_template_validity</span><span
            class="method-args">(vm_tpl_opaqueref)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Refactor: Check Template Validity</p>
          
          

          
          <div class="method-source-code" id="check_vm_template_validity-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 980</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_vm_template_validity</span>(<span class="ruby-identifier">vm_tpl_opaqueref</span>)
  <span class="ruby-identifier">check_vm_entity_is_nonexist</span>(<span class="ruby-identifier">vm_tpl_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">check_vm_entity_is_dom0</span>(<span class="ruby-identifier">vm_tpl_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">check_vm_entity_is_template</span>(<span class="ruby-identifier">vm_tpl_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">check_vm_entity_is_paravirtual</span>(<span class="ruby-identifier">vm_tpl_opaqueref</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">vm_tpl_opaqueref</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">vm_tpl_opaqueref</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-number-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">number?</span><span
            class="method-args">(string)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p><a
href="https://stackoverflow.com/questions/5661466/test-if-string-is-a-number-in-ruby-on-rails">stackoverflow.com/questions/5661466/test-if-string-is-a-number-in-ruby-on-rails</a></p>
          
          

          
          <div class="method-source-code" id="number-3F-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 1052</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">number?</span>(<span class="ruby-identifier">string</span>)
  <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">string</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Integer</span><span class="ruby-operator">::</span><span class="ruby-constant">ArgumentError</span>
  <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parse_last_boot_record" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_last_boot_record</span><span
            class="method-args">(raw_last_boot_record)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Parse the last boot record to Hash. You may say why don&#39;t I just put
JSON.parse. The main problem is some VM that uses maybe older XS Guest
Additions generates (&#39;struct&#39;) instead of pretty JSON string This
parser is adapted from <a
href="https://gist.github.com/ascendbruce/7070951">gist.github.com/ascendbruce/7070951</a></p>
          
          

          
          <div class="method-source-code" id="parse_last_boot_record-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 1028</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_last_boot_record</span>(<span class="ruby-identifier">raw_last_boot_record</span>)
  <span class="ruby-identifier">parsed</span> = <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">raw_last_boot_record</span>)
  <span class="ruby-comment"># Also need to convert mess stuffs to Human-readable</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">parsed</span>[<span class="ruby-string">&#39;last_start_time&#39;</span>] = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-identifier">parsed</span>[<span class="ruby-string">&#39;last_start_time&#39;</span>]).<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-identifier">parsed</span>[<span class="ruby-string">&#39;last_start_time&#39;</span>] = <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">parsed</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">JSON</span><span class="ruby-operator">::</span><span class="ruby-constant">ParserError</span>
  <span class="ruby-comment"># Ruby rescue is catch in other languages</span>
  <span class="ruby-comment"># Parsing struct is farrrrrrr to difficult</span>
  <span class="ruby-constant">Messages</span>.<span class="ruby-identifier">error_unsupported</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-random_mac" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">random_mac</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p><a
href="https://github.com/andrewgho/genmac">github.com/andrewgho/genmac</a></p>
          
          

          
          <div class="method-source-code" id="random_mac-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 1059</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">random_mac</span>
  (<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">6</span>).<span class="ruby-identifier">collect</span> { <span class="ruby-identifier">format</span>(<span class="ruby-string">&#39;%02x&#39;</span>, (<span class="ruby-identifier">rand</span> <span class="ruby-value">255</span>)) }.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39;:&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-xml_parse" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">xml_parse</span><span
            class="method-args">(raw_xml)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>XML Parser, important <a
href="https://github.com/savonrb/nori">github.com/savonrb/nori</a></p>
          
          

          
          <div class="method-source-code" id="xml_parse-source">
            <pre><span class="ruby-comment"># File xenapi.rb, line 1046</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">xml_parse</span>(<span class="ruby-identifier">raw_xml</span>)
  <span class="ruby-identifier">xml_parser</span> = <span class="ruby-constant">Nori</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">convert_tags_to</span><span class="ruby-operator">:</span> <span class="ruby-operator">-</span><span class="ruby-operator">&gt;</span>(<span class="ruby-identifier">tag</span>) { <span class="ruby-identifier">tag</span>.<span class="ruby-identifier">snakecase</span> })
  <span class="ruby-identifier">xml_parser</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">raw_xml</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.0.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

